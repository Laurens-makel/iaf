<?xml version="1.0" encoding="UTF-8"?>
<Configuration>
    <Appenders>
        <Console name="stdout" target="SYSTEM_OUT">
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%t] %x %c{1} %m%n"/>
        </Console>
        <RollingFile name="file" fileName="${log.dir}/${instance.name.lc}.log" filePattern="${log.dir}/${instance.name.lc}.%i.log">
            <PatternLayout
                    pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%t] %x %c{2} - %m%n %replace{%msg}{${log.hideRegex}}{***} $.-${log.lengthLogRecords}c"/>
            <IbisThreadFilter onMatch="NEUTRAL" onMismatch="DENY" regex="${log.thread.rejectRegex}" />
            <Policies>
                <SizeBasedTriggeringPolicy size="${log.maxFileSize}"/>
            </Policies>
            <DefaultRolloverStrategy max="${log.maxBackupIndex}"/>
        </RollingFile>
        <RollingFile name="galm" fileName="${log.dir}/${instance.name.lc}-galm.log" filePattern="${log.dir}/${instance.name.lc}-galm.%i.log">
            <PatternLayout pattern="%m%n"/>
            <Policies>
                <SizeBasedTriggeringPolicy size="100KB"/>
            </Policies>
            <DefaultRolloverStrategy max="5"/>
        </RollingFile>
        <RollingFile name="msg" fileName="${log.dir}/${instance.name.lc}-messages.log" filePattern="${log.dir}/${instance.name.lc}-messages.%i.log" append="true">
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} [%t] %m%n"/>
            <Policies>
                <SizeBasedTriggeringPolicy size="${log.maxFileSize}"/>
            </Policies>
            <DefaultRolloverStrategy max="${log.msg.maxBackupIndex}"/>
        </RollingFile>
        <RollingFile name="security" fileName="${log.dir}/${instance.name.lc}-security.log" filePattern="${log.dir}/${instance.name.lc}-security.%i.log">
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} [%t] %m%n"/>
            <Policies>
                <SizeBasedTriggeringPolicy size="${log.maxFileSize}"/>
            </Policies>
            <DefaultRolloverStrategy max="${log.maxBackupIndex}"/>
        </RollingFile>
        <RollingFile name="heartbeat" fileName="${log.dir}/${instance.name.lc}-heartbeat.log" filePattern="${log.dir}/${instance.name.lc}-heartbeat.%i.log">
            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p %m%n"/>
            <Policies>
                <SizeBasedTriggeringPolicy size="${log.maxFileSize}"/>
            </Policies>
            <DefaultRolloverStrategy max="${log.maxBackupIndex}"/>
        </RollingFile>
    </Appenders>
    <Loggers>
        <Logger name="nl.nn.adapterframework.testtool">
            <level value="WARN"/>
        </Logger>
        <Logger name="org.apache">
            <level value="INFO"/>
        </Logger>
        <Logger name="org.apache.commons">
            <level value="WARN"/>
        </Logger>
        <Logger name="GALM" additivity="false">
            <level value="INFO"/>
            <AppenderRef  ref="galm"/>
        </Logger>
        <Logger name="MSG" additivity="false">
            <level value="INFO"/>
            <AppenderRef  ref="msg"/>
        </Logger>
        <Logger name="SEC" additivity="false">
            <level value="INFO"/>
            <AppenderRef  ref="security"/>
        </Logger>
        <Logger name="HEARTBEAT" additivity="false">
            <level value="INFO"/>
            <AppenderRef  ref="heartbeat"/>
        </Logger>

        <!-- Debug JMS polling on local development machine -->
        <!-- appender name="stdout-local-development" class="org.apache.log4j.ConsoleAppender">
            <layout class="org.apache.log4j.EnhancedPatternLayout">
                <param name="ConversionPattern" value="%m%n"/>
            </layout>
        </appender>
        <logger name="nl.nn.adapterframework.unmanaged">
            <level value="TRACE"/>
            <appender-ref ref="stdout-local-development"/>
        </logger>
        <logger name="nl.nn.adapterframework.jms.IbisMessageListenerContainer">
            <level value="TRACE"/>
            <appender-ref ref="stdout-local-development"/>
        </logger -->

        <!-- Add root below loggers because: The content of element type "log4j:configuration" must match "(renderer*,throwableRenderer?,appender*,plugin*,(category|logger)*,root?,(categoryFactory|loggerFactory)?)". -->
        <Root>
            <level value="${log.level}"/>
            <AppenderRef  ref="file"/>
        </Root>
    </Loggers>
</Configuration>